<?xml version="1.0"?>
<BeHappy.Extension xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://workspaces.gotdotnet.com/behappy">
	<AudioDSP UniqueID="9579E57B-2D27-4583-99A4-921718E25B41">
		<Plugin>
			<MultiOptionDSP Type="BeHappy.Extensions.MultiOptionDSP, BeHappy">
				<DialogWidth>450</DialogWidth>				
				<TitleFormatString>5.1 Upmix - {0}</TitleFormatString>
				<ScriptPrologue>
					# Store clip in variable
					Stereo_{2} = last
					function f{2}(clip a) {3}
				</ScriptPrologue>
				<Option>
					<ToolTip>
						Profile to use with audio sources that have mostly mono content. 20ms delay and -3db attenuation on surround
						Note: the center channel is very weak for this profile
					</ToolTip>
					<Name>Audio with mostly dialog (ie. Comedy, Drama)</Name>
					<Value>
						# Profile to use with audio sources that have mostly mono content. 20ms delay and -3db attenuation on surround
						# Note: the center channel is very weak for this profile
						front = a.soxfilter("filter 20-20000")
						back = a.soxfilter("filter 100-7000")
						fl = mixaudio(front.GetLeftChannel(),front.GetRightChannel(),0.794,-0.794)
						fr = mixaudio(front.GetRightChannel(),front.GetLeftChannel(),0.794,-0.794)
						cc = mixaudio(mixaudio(front.GetLeftChannel(),fl,1,-1),mixaudio(front.GetRightChannel(),fr,1,-1),0.224,0.224)
						lfe = ConvertToMono(a).SoxFilter("lowpass 120","vol -0.596")
						sl = mixaudio(back.GetLeftChannel(),back.GetRightChannel(),0.562,-0.562)
						sr = mixaudio(back.GetRightChannel(),back.GetLeftChannel(),0.562,-0.562)
						sl = DelayAudio(sl,0.02)
						sr = DelayAudio(sr,0.02)
					</Value>
				</Option>
				<Option default="true">
					<ToolTip>
						Profile to use with audio sources that have a wider range of sound content. 20ms delay and -3db attenuation on surround
						Note: General purpose profile
					</ToolTip>					
					<Name>Audio with a mix of sounds (ie. Action, Adventure)</Name>
					<Value>
						# Profile to use with audio sources that have a wider range of sound content. 20ms delay and -3db attenuation on surround
						# Note: General purpose profile
						front = a.soxfilter("filter 20-20000")
						back = a.soxfilter("filter 100-7000")
						fl = mixaudio(front.GetLeftChannel(),front.GetRightChannel(),0.668,-0.668)
						fr = mixaudio(front.GetRightChannel(),front.GetLeftChannel(),0.668,-0.668)
						cc = mixaudio(mixaudio(front.GetLeftChannel(),fl,1,-1),mixaudio(front.GetRightChannel(),fr,1,-1),0.398,0.398)
						lfe = ConvertToMono(a).SoxFilter("lowpass 120","vol -0.447")
						sl = mixaudio(back.GetLeftChannel(),back.GetRightChannel(),0.473,-0.473)
						sr = mixaudio(back.GetRightChannel(),back.GetLeftChannel(),0.473,-0.473)
						sl = DelayAudio(sl,0.02)
						sr = DelayAudio(sr,0.02)
					</Value>
				</Option>
				<Option>
					<ToolTip>
						Gerzen approach Profile modified with 20ms delay and some attenuation on surround
					</ToolTip>
					<Name>Gerzen Profile</Name>
					<Value>
						# Gerzen approach Profile modified with 20ms delay and some attenuation on surround
						front = a.soxfilter("filter 20-20000")
						back = a.soxfilter("filter 100-7000")
						fl = mixaudio(front.GetLeftChannel(),front.GetRightChannel(),0.885,-0.115)
						fr = mixaudio(front.GetRightChannel(),front.GetLeftChannel(),0.885,-0.115)
						cc = mixaudio(front.GetRightChannel(),front.GetLeftChannel,0.4511,0.4511)
						lfe = ConvertToMono(a).SoxFilter("lowpass 120","vol -0.5")
						sl = mixaudio(back.GetLeftChannel(),back.GetRightChannel(),0.668,-0.668)
						sr = mixaudio(back.GetRightChannel(),back.GetLeftChannel(),0.668,-0.668)
						sl = DelayAudio(sl,0.02)
						sr = DelayAudio(sr,0.02)
					</Value>
				</Option>
				<Option>
					<ToolTip>
						Farina/Sursound approach Profile M=L+R, S=L-R, c=0.75, L' = (1-c/4)*M+(1+c/4)*S, C' = c*M, R' = (1-c/4)*M-(1+c/4)*S
						also added with 20ms delay and some attenuation on surround
					</ToolTip>					
					<Name>Farina Profile</Name>
					<Value>
						# Farina/Sursound approach Profile M=L+R, S=L-R, c=0.75, L' = (1-c/4)*M+(1+c/4)*S, C' = c*M, R' = (1-c/4)*M-(1+c/4)*S
						# also added with 20ms delay and some attenuation on surround
						front = a.soxfilter("filter 20-20000")
						back = a.soxfilter("filter 100-7000")
						fl = mixaudio(mixaudio(front.GetLeftChannel(),front.GetRightChannel(),0.500,0.500),mixaudio(front.GetLeftChannel(),front.GetRightChannel(),0.500,-0.500),0.8125,1.1875)
						fr = mixaudio(mixaudio(front.GetLeftChannel(),front.GetRightChannel(),0.500,0.500),mixaudio(front.GetLeftChannel(),front.GetRightChannel(),0.500,-0.500),0.8125,-1.1875)
						cc = mixaudio(front.GetRightChannel(),front.GetLeftChannel,0.375,0.375)
						lfe = ConvertToMono(a).SoxFilter("lowpass 120","vol -0.5")
						sl = mixaudio(back.GetLeftChannel(),back.GetRightChannel(),0.668,-0.668)
						sr = mixaudio(back.GetRightChannel(),back.GetLeftChannel(),0.668,-0.668)
						sl = DelayAudio(sl,0.02)
						sr = DelayAudio(sr,0.02)
					</Value>
				</Option>
				<Option>
					<ToolTip>
						Multisonic approach Profile modified with 20ms delay and some attenuation on surround
					</ToolTip>					
					<Name>Multisonic Profile</Name>
					<Value>
						# Multisonic approach Profile modified with 20ms delay and some attenuation on surround
						front = a.soxfilter("filter 20-20000")
						back = a.soxfilter("filter 100-7000")
						fl = mixaudio(front.GetLeftChannel(),front.GetRightChannel(),1,-0.5)
						fr = mixaudio(front.GetRightChannel(),front.GetLeftChannel(),1,-0.5)
						cc = mixaudio(front.GetRightChannel(),front.GetLeftChannel,0.5,0.5)
						lfe = ConvertToMono(a).SoxFilter("lowpass 120","vol -0.5")
						sl = mixaudio(back.GetLeftChannel(),back.GetRightChannel(),0.668,-0.668)
						sr = mixaudio(back.GetRightChannel(),back.GetLeftChannel(),0.668,-0.668)
						sl = DelayAudio(sl,0.02)
						sr = DelayAudio(sr,0.02)
					</Value>
				</Option>
				<Option>
					<ToolTip>
						SOS approach Profile with 20ms delay and some attenuation on surround
					</ToolTip>					
					<Name>Sound On Sound Profile</Name>
					<Value>
						# SOS approach Profile with 20ms delay and some attenuation on surround
						back = a.soxfilter("filter 100-7000")
						fl = a.GetLeftChannel()
						fr = a.GetRightChannel()
						cc = mixaudio(a.GetRightChannel(),a.GetLeftChannel,0.5,0.5)
						lfe = ConvertToMono(a).SoxFilter("lowpass 120","vol -0.5")
						sl = mixaudio(back.GetLeftChannel(),back.GetRightChannel(),0.668,-0.668)
						sr = mixaudio(back.GetRightChannel(),back.GetLeftChannel(),0.668,-0.668)
						sl = DelayAudio(sl,0.02)
						sr = DelayAudio(sr,0.02)
					</Value>
				</Option>
				<ScriptEpilogue>
					# Return result
					return MergeChannels( fl, fr, cc, lfe, sl, sr)
					{4}
					# Call function
					2==AudioChannels(Stereo_{2})?f{2}(ConvertAudioToFloat(Stereo_{2})):Stereo_{2}
				</ScriptEpilogue>
				<LogoBitmap>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</LogoBitmap>
			</MultiOptionDSP>
		</Plugin>
	</AudioDSP>
</BeHappy.Extension>
